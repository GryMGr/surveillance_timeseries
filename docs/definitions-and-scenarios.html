<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Time Series and Longitudinal Analysis</title>
  <meta name="description" content="A short course in learning which statistical methods should be applied where.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Time Series and Longitudinal Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A short course in learning which statistical methods should be applied where." />
  <meta name="github-repo" content="folkehelseinstituttet/surveillance_timeseries" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Time Series and Longitudinal Analysis" />
  
  <meta name="twitter:description" content="A short course in learning which statistical methods should be applied where." />
  

<meta name="author" content="Richard White">


<meta name="date" content="2018-11-02">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="panel-data-one-area.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series/Longitudinal</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="definitions-and-scenarios.html"><a href="definitions-and-scenarios.html"><i class="fa fa-check"></i><b>1</b> Definitions and Scenarios</a><ul>
<li class="chapter" data-level="1.1" data-path="definitions-and-scenarios.html"><a href="definitions-and-scenarios.html#panel-data"><i class="fa fa-check"></i><b>1.1</b> Panel Data</a></li>
<li class="chapter" data-level="1.2" data-path="definitions-and-scenarios.html"><a href="definitions-and-scenarios.html#autocorrelation"><i class="fa fa-check"></i><b>1.2</b> Autocorrelation</a></li>
<li class="chapter" data-level="1.3" data-path="definitions-and-scenarios.html"><a href="definitions-and-scenarios.html#scenarios"><i class="fa fa-check"></i><b>1.3</b> Scenarios</a></li>
<li class="chapter" data-level="1.4" data-path="definitions-and-scenarios.html"><a href="definitions-and-scenarios.html#useful-code"><i class="fa fa-check"></i><b>1.4</b> Useful Code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="panel-data-one-area.html"><a href="panel-data-one-area.html"><i class="fa fa-check"></i><b>2</b> Panel Data - One Area</a><ul>
<li class="chapter" data-level="2.1" data-path="panel-data-one-area.html"><a href="panel-data-one-area.html#aim"><i class="fa fa-check"></i><b>2.1</b> Aim</a></li>
<li class="chapter" data-level="2.2" data-path="panel-data-one-area.html"><a href="panel-data-one-area.html#data"><i class="fa fa-check"></i><b>2.2</b> Data</a></li>
<li class="chapter" data-level="2.3" data-path="panel-data-one-area.html"><a href="panel-data-one-area.html#model-with-non-parametric-seasonality"><i class="fa fa-check"></i><b>2.3</b> Model With Non-Parametric Seasonality</a></li>
<li class="chapter" data-level="2.4" data-path="panel-data-one-area.html"><a href="panel-data-one-area.html#model-with-parametric-seasonality"><i class="fa fa-check"></i><b>2.4</b> Model With Parametric Seasonality</a></li>
<li class="chapter" data-level="2.5" data-path="panel-data-one-area.html"><a href="panel-data-one-area.html#autocorrelation-1"><i class="fa fa-check"></i><b>2.5</b> Autocorrelation</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.fhi.no/" target="blank">www.fhi.no</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Time Series and Longitudinal Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="definitions-and-scenarios" class="section level1">
<h1><span class="header-section-number">1</span> Definitions and Scenarios</h1>
<div id="panel-data" class="section level2">
<h2><span class="header-section-number">1.1</span> Panel Data</h2>
<p>Panel data is a set of data with measurements repeated at equally spaced points. For example, number of influenza cases recorded every day, or every week, or every year would be considered panel data. The number of influenza cases on Jan 31, Feb 3, and Nov 21 in 2018 would not be considered panel data.</p>
</div>
<div id="autocorrelation" class="section level2">
<h2><span class="header-section-number">1.2</span> Autocorrelation</h2>
<p>When you have panel data, autocorrelation is the correlation between subsequent observations. For example, if you have daily observations, then the 1 day autocorrelation is the correlation between observations 1 day apart, and likewise the 2 day autocorrelation is the correlation between observations 2 days apart.</p>
</div>
<div id="scenarios" class="section level2">
<h2><span class="header-section-number">1.3</span> Scenarios</h2>
<p>In this course we will consider three scenarios where we have multiple observations for each geographical area:</p>
<ul>
<li>Panel data: One geographical area, with/without autocorrelation</li>
<li>Not panel data: Multiple geographical areas</li>
<li>Panel data: Multiple geographical areas, with/without autocorrelation</li>
</ul>
<p>Note, the following scenario can be covered by standard regression models:</p>
<ul>
<li>Multiple geographical areas, one time point/observation per geographical area</li>
</ul>
</div>
<div id="useful-code" class="section level2">
<h2><span class="header-section-number">1.4</span> Useful Code</h2>
<p>This code is used to calculate prediction intervals. In its most basic form it is:</p>
<p><span class="math display">\[
95\% \text{ CI} = \text{sample average} \pm 1.96 \times \text{sample standard deviation} \sqrt{ 1 + 1 / n}
\]</span> However, due to the skewness of the count data, we often choose to use a <code>2/3s transformation</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">FarringtonThreshold &lt;-<span class="st"> </span><span class="cf">function</span>(pred, phi, <span class="dt">alpha =</span> <span class="ot">NULL</span>, <span class="dt">z =</span> <span class="ot">NULL</span>, <span class="dt">skewness.transform =</span> <span class="st">&quot;none&quot;</span>) {
  mu0 &lt;-<span class="st"> </span>pred<span class="op">$</span>fit
  tau &lt;-<span class="st"> </span>phi <span class="op">+</span><span class="st"> </span>(pred<span class="op">$</span>se.fit<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>mu0
  <span class="cf">switch</span>(skewness.transform, <span class="dt">none =</span> {
    se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(mu0 <span class="op">*</span><span class="st"> </span>tau)
    exponent &lt;-<span class="st"> </span><span class="dv">1</span>
  }, <span class="st">`</span><span class="dt">1/2</span><span class="st">`</span> =<span class="st"> </span>{
    se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span>tau)
    exponent &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>
  }, <span class="st">`</span><span class="dt">2/3</span><span class="st">`</span> =<span class="st"> </span>{
    se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">4</span> <span class="op">/</span><span class="st"> </span><span class="dv">9</span> <span class="op">*</span><span class="st"> </span>mu0<span class="op">^</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">3</span>) <span class="op">*</span><span class="st"> </span>tau)
    exponent &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">3</span>
  }, {
    <span class="kw">stop</span>(<span class="st">&quot;No proper exponent in algo.farrington.threshold.&quot;</span>)
  })
  <span class="cf">if</span> (<span class="kw">is.null</span>(z)) z &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)
  lu &lt;-<span class="st"> </span>(mu0<span class="op">^</span>exponent <span class="op">+</span><span class="st"> </span>z <span class="op">*</span>
<span class="st">    </span>se)<span class="op">^</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>exponent)

  <span class="kw">return</span>(lu)
}</code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="panel-data-one-area.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["website.pdf", "website.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
